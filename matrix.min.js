/*
 *	Transformation Matrix JS v1.4 (c) Epistemex 2014
 *	www.epistemex.com
 *	License: MIT, this header required.
*/
function Matrix(a){this.a=1;this.c=this.b=0;this.d=1;this.f=this.e=0;(this.context=a)&&a.setTransform(1,0,0,1,0,0)}Matrix.prototype.flipX=function(){this.transform(-1,0,0,1,0,0);return this};Matrix.prototype.flipY=function(){this.transform(1,0,0,-1,0,0);return this};Matrix.prototype.reset=function(){this.a=this.d=1;this.b=this.c=this.e=this.f=0;this._setCtx();return this};Matrix.prototype.rotate=function(a){var b=Math.cos(a);a=Math.sin(a);this.transform(b,a,-a,b,0,0);return this};Matrix.prototype.rotateDeg=function(a){this.rotate(a*Math.PI/180);return this};Matrix.prototype.scale=function(a,b){this.transform(a,0,0,b,0,0);return this};Matrix.prototype.scaleX=function(a){this.transform(a,0,0,1,0,0);return this};Matrix.prototype.scaleY=function(a){this.transform(1,0,0,a,0,0);return this};Matrix.prototype.skew=function(a,b){this.transform(1,b,a,1,0,0);return this};Matrix.prototype.skewX=function(a){this.transform(1,0,a,1,0,0);return this};Matrix.prototype.skewY=function(a){this.transform(1,a,0,1,0,0);return this};Matrix.prototype.setTransform=function(a,b,c,d,g,h){this.a=a;this.b=b;this.c=c;this.d=d;this.e=g;this.f=h;this._setCtx();return this};Matrix.prototype.translate=function(a,b){this.transform(1,0,0,1,a,b);return this};Matrix.prototype.translateX=function(a){this.transform(1,0,0,1,a,0);return this};Matrix.prototype.translateY=function(a){this.transform(1,0,0,1,0,a);return this};Matrix.prototype.transform=function(a,b,c,d,g,h){var e=this.a,f=this.b,k=this.c,l=this.d,m=this.e,n=this.f;this.a=e*a+k*b;this.b=f*a+l*b;this.c=e*c+k*d;this.d=f*c+l*d;this.e=e*g+k*h+m;this.f=f*g+l*h+n;this._setCtx();return this};Matrix.prototype.getInverse=function(){var a=this.a,b=this.b,c=this.c,d=this.d,g=this.e,h=this.f,e=new Matrix,f=a*d-b*c;e.a=d/f;e.b=-b/f;e.c=-c/f;e.d=a/f;e.e=(c*h-d*g)/f;e.f=-(a*h-b*g)/f;return e};Matrix.prototype.interpolate=function(a,b){var c=new Matrix;c.a=this.a+(a.a-this.a)*b;c.b=this.b+(a.b-this.b)*b;c.c=this.c+(a.c-this.c)*b;c.d=this.d+(a.d-this.d)*b;c.e=this.e+(a.e-this.e)*b;c.f=this.f+(a.f-this.f)*b;return c};Matrix.prototype.applyToPoint=function(a,b){return{x:a*this.a+b*this.c+this.e,y:a*this.b+b*this.d+this.f}};Matrix.prototype.applyToArray=function(a){var b=0,c,d=[];if("number"===typeof a[0])for(;b<a.length;)c=this.applyToPoint(a[b++],a[b++]),d.push(c.x,c.y);else for(;b<a.length;)c=this.applyToPoint(a[b].x,a[b++].y),d.push(c);return d};Matrix.prototype.applyToContext=function(a){a.setTransform(this.a,this.b,this.c,this.d,this.e,this.f);return this};Matrix.prototype.isIdentity=function(){return this._isEqual(this.a,1)&&this._isEqual(this.b,0)&&this._isEqual(this.c,0)&&this._isEqual(this.d,1)&&this._isEqual(this.e,0)&&this._isEqual(this.f,0)};Matrix.prototype.isEqual=function(a){return this._isEqual(this.a,a.a)&&this._isEqual(this.b,a.b)&&this._isEqual(this.c,a.c)&&this._isEqual(this.d,a.d)&&this._isEqual(this.e,a.e)&&this._isEqual(this.f,a.f)};Matrix.prototype._isEqual=function(a,b){return 1E-14>Math.abs(a-b)};Matrix.prototype._setCtx=function(){this.context&&this.context.setTransform(this.a,this.b,this.c,this.d,this.e,this.f)};